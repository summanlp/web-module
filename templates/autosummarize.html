$def with (text="", summary="", languages={})
$var title: Summarizer

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h2>Summarization tool</h2>
        </div>
    </div>

    <br />

    <form role="form" class="form-horizontal">
        <div class="row">
            <div class="col-md-9">
                
                <div class="row">
                    <div class="col-md-12">
                        <textarea class="form-control" name="text" id="text" style="resize: none; font-size:15px; line-height: 120%;" 
                            cols="90" rows="15" placeholder="Enter a text to summarize..." required>$text</textarea>    
                    </div>
                </div>
                               
                <br />
                               
                <div class="row">
                    <div class="col-md-12">
                        <div class="pull-right">
                            <div class="btn-group">
                                <a class="btn btn-success btn-lg submits" data-value="keywords">Keywords</a>
                                <a href="#" class="btn btn-success btn-lg dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li><a class="exports" data-value="keywords">Export graph</a></li>
                                </ul>
                            </div>

                            <div class="btn-group">
                                <a class="btn btn-primary btn-lg submits" data-value="summarize">Summarize</a>
                                <a href="#" class="btn btn-primary btn-lg dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li><a class="exports" data-value="summarize">Export graph</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>  
                
                <br />                      
            </div>
            
            <div class="col-md-3">
                <div class="form-group">
                    <div class="col-lg-12">
                        <a class="btn btn-default btn-s" id="btn-load-sample">Load sample text</a>
                    </div>
                </div>

                <div class="form-group">
                    <label class="control-label col-lg-3" for="length">Length</label>
                    <div class="col-lg-9">
                        <input id="ex1" name="length" type="text" data-slider-min="0" data-slider-max="100" 
                            data-slider-step="10" data-slider-value="20" class="form-control col-md-12" />
                    </div>
                </div> 

                <div class="form-group">
                    <label class="control-label col-lg-3" for="language">Language</label>
                    <div class="col-lg-9">
                        <select class="form-control" name="language" id="language">
                            $for key,name in languages.iteritems():
                                $if key == "english":
                                    <option value="$key" selected>$name</option>
                                $else:
                                    <option value="$key">$name</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="control-label col-lg-3" for="scores">Scores</label>
                    <div class="col-lg-9">
                        <input id="showScores" name="scores" type="checkbox">
                    </div>
                </div>
            </div>
        </div>
    </form>
        
    <div class="col-md-offset-1 col-md-6 progress progress-striped active" style="display:none;">
        <div class="progress-bar" style="width: 100%"></div>
    </div>

    <div id="results" class="row" style="display:none;">
        <div class="col-md-12">
            <h4 id="resulttitle"></h4>
        </div>
        
        <div class="col-md-12">
            <p id="summary"></p>
        </div>
    </div>
</div>        

<script>
    $$(document).ready(function() {
        $$('#ex1').slider({
            formatter: function(value) {
                return value + "%";
            }
        });

        $$("#showScores").bootstrapSwitch();
        
        $$(".submits").click(function(event) {
            event.preventDefault();
            if ($$("#text").val().length > 0) {
                $$("#results").hide();
                $$(".progress").toggle();
                postData($$(this).data("value"));
            }
        });

        $$(".exports").click(function(event) {
            event.preventDefault();
            if ($$("#text").val().length > 0) {
                $$("#results").hide();
                $$(".progress").toggle();
                exportData($$(this).data("value"));
            }
        });
        
        jQuery('#btn-load-sample').click(
            function() {
                jQuery.ajax({
                    url: "sample"
                }).done(
                    function(data) {
                        jQuery('#text').html(data);
                    }
                );
            }
        );

        function postData(methodName) {
            $$.post("/", {
                text: $$("#text").val(),
                scores: $$("#showScores").bootstrapSwitch('state'),
                length: $$("#ex1").val(),
                language: $$("#language").val(),
                method: methodName
            }, function(data) {
                $$(".progress").toggle();
                var title = methodName == "summarize" ? "Summary" : "Keywords"
                $$("#resulttitle").html(title);
                $$("#summary").html(data);
                $$("#results").show();
                scrollToResults();
            });
        }

        function exportData(methodName) {
            nonAjaxPost("/gexf", {
                text: $$("#text").val(),
                language: $$("#language").val(),
                method: methodName
            });
        }

        function nonAjaxPost(action, input) {
            'use strict';
            var form;
            form = $$('<form />', {
                action: action,
                method: "POST",
                style: 'display: none;'
            });
            if (typeof input !== 'undefined' && input !== null) {
                $$.each(input, function (name, value) {
                    $$('<input />', {
                        type: 'hidden',
                        name: name,
                        value: value
                    }).appendTo(form);
                });
            }
            form.appendTo('body').submit();
        }
        
        function scrollToResults() {
            $$('html, body').animate({
                scrollTop: $$('#results').offset().top
            }, 2000);
        }

    });
</script>